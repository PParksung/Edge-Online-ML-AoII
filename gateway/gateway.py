import sys
import serial
import time
import json
import os
from datetime import datetime, timezone, timedelta
from gateway_MLP_Logic import GatewayMLP
import paho.mqtt.client as mqtt

_project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.insert(0, _project_root)

_env_path = os.path.join(_project_root, ".env")
if os.path.isfile(_env_path):
    with open(_env_path, "r", encoding="utf-8") as _f:
        for _line in _f:
            _line = _line.strip()
            if _line and not _line.startswith("#") and "=" in _line:
                _k, _v = _line.split("=", 1)
                _k, _v = _k.strip(), _v.strip()
                if _k.startswith("MQTT_") or _k.startswith("SERIAL_"):
                    os.environ[_k] = _v

MQTT_BROKER = os.environ.get("MQTT_BROKER", "localhost")
MQTT_PORT = int(os.environ.get("MQTT_PORT", "1883"))
MQTT_TOPIC_READINGS = "aoii/readings"

# =========================================================
# 1. 12-64-32-2 Rolling Window ReLU 모델 파라미터
#    *** Pre_train.py 실행 후 아래 값을 교체할 것 ***
# =========================================================
X_MEAN = [11.950083672005688, 34.8013387520918, 0.5186181003798486, 11.951278986373369, 34.79715515180492, 0.5187226903870206, 11.952605785321493, 34.79189576858714, 0.5188226319494292, 11.953801099689171, 34.78651685393258, 0.5189264748851214]
X_STD  = [5.193259747163538, 19.256053082753755, 0.28762354954129254, 5.1930639451367915, 19.2552490345571, 0.2876081740921169, 5.1927057443025575, 19.253007658873344, 0.28760116802782554, 5.192256114892461, 19.250294461427767, 0.2876020006450507]
Y_MEAN = [11.954996414056849, 34.77958403060005]
Y_STD  = [5.191552911143374, 19.24373266977566]

W1 = [[-0.023120652828509045, 0.1720798664073973, 0.13024610023384026, 0.14911577766962975, -0.10039047364519653, -0.1654583181189653, -0.21588838998318174, 0.18944941767356835, 0.10879583562300608, 0.09439561947451454, -0.13344228831060684, 0.23151403104468996, 0.24541950303011426, -0.15105399080959975, -0.16474985084223512, -0.14813284272150812, -0.09178328963587633, 0.02649948153107912, -0.09243906675841304, -0.09033879936092064, 0.0512710996991205, -0.21364022971585855, -0.15067133585368128, -0.008120633212487287, -0.10751684058368609, 0.23288600443128168, -0.17820424251819122, 0.054482342035070186, -0.027933992681215287, -0.1995367128048901, 0.023407749707000398, -0.22074500598302674, -0.13245437509628566, 0.28265365621061356, 0.2172143350900973, 0.017330904582103783, -0.03391688575327737, -0.1860449035924921, 0.1288688746617494, -0.06380890312776064, -0.29545673189683075, -0.018118418655091756, -0.16354245849195354, 0.19910303584719707, -0.06092494673473401, 0.13757647747956092, 0.02387244454125545, -0.08622728793151273, 0.06267585784396686, -0.19443113117788105, 0.20928039605106996, 0.2594565329128782, 0.31542785723596445, 0.21801444607525788, 0.1158767322902427, 0.24092299533464828, -0.24452956997923347, -0.31038666759346084, -0.23314831632546434, -0.02575027187664703, -0.015924022839452698, -0.04545223382985889, 0.28548950454359684, -0.08437484114493349], [2.3140320361116377e-05, -6.464267544790714e-05, -0.113811070852892, 0.06971662997381668, -0.28345360780518586, 0.20929499954734107, 0.1552739329096116, -0.14281396500488763, -0.3685309286446301, 0.17870581836997698, 0.055856923640857606, 0.1328461642296621, 0.10675486553374014, -0.21663659826664983, -0.15059725378918565, -0.2922444808712667, 0.1273270867961859, 0.06403150039090813, -0.09182913047464301, -0.25060359101885593, -0.07307110770320702, -0.09431372945437493, 0.13797085359347513, 0.08831641679994583, 0.2397015507947363, -0.024430966878151567, -0.1613928365373582, 0.15986313842518818, 0.22605351925917427, -0.013430587116880404, 0.08105351437572722, -0.0010136946683143389, -0.051341088282179495, -0.030868169096789078, -0.14187146521934807, -0.17222899972715155, -0.221023150910048, 0.0302120214512912, -0.10437988904933505, -0.019284795014885996, 0.16939519164754738, -0.05985174323945655, -0.05059651245517563, 0.1539317764026197, -0.15506815478679437, -0.18503447604701517, -0.052537879710437926, -0.12335122296688435, 0.19246601016572576, 0.16490964114488899, 0.1085032195252086, 0.17314316938942692, 0.13834662089182972, -0.18248703923948326, 0.19824116587894886, -0.044263018155554244, 0.15148021065337952, 0.17162347604259565, -0.1423242332035918, -0.18771780412328962, -0.21067709108590035, -0.053704019418577394, 0.18566496357679257, 0.21560660195527928], [-0.24931263414761526, -0.05467391872334044, -0.03401263057140155, -0.24095351180578004, -0.16703043971070777, -0.11350157955204358, 0.2361634449920026, -0.11849783827444507, 0.05812742220430454, 0.10383252191897623, -0.12085032667285207, 0.2702416818731913, 0.26453375061249507, -0.10527788127975897, 0.020667475075050623, -0.13834548905907074, -0.10385735362452396, -0.3009802843126003, 0.10860443041756856, 0.016834337036736542, -0.1412350728142819, -0.1776777951497236, 0.18981873380993786, -0.11223091892812002, -0.1636527147782537, 0.04779694498316313, 0.15546212734846074, -0.14254163842213033, 0.09163377216544077, 0.17389257748571288, -0.13496130041167353, 0.17616026468680226, -0.09577914580739147, 0.04391603996023287, 0.014988083074516228, 0.032312321266109986, -0.3652977822266555, 0.1666805235161531, -0.11388871577226019, -0.19322634188582977, -0.3315109547634144, 0.01906975588047589, 0.03860534528849379, -0.28942484294968973, 0.0073039108237766045, -0.034631043211309304, 0.056083004471709656, -0.17990795303688817, 0.26709013057343917, -0.0627839160391123, 0.3361401087998737, -0.18382884234473176, -0.08891150781784433, -0.0952764936615991, 0.2866861203212596, 0.18314433427514545, -0.0810585968789361, 0.020682238302660496, 0.14128840331675482, 0.09519283911902367, 0.07022935267679717, -0.27328170085419745, -0.15847952447364688, 0.2518118442693169], [0.2034132596261873, 0.020727931888754592, -0.034528928043150636, -0.1054694586510838, 0.10228003068382419, 0.18498390032797876, 0.23818055915617237, 0.18396161098755537, 0.00873164589417673, -0.18109820363539933, -0.18395241346754965, 0.19198833078077412, 0.07794796911854233, -0.193488290545134, -0.27249747959976756, 0.048169260223126426, -0.20234963779178203, -0.2430932543094393, -0.11111871004429248, 0.10443691168711787, 0.12619591053268583, -0.13369739747041032, 0.13064991792678032, -0.057859177108711884, -0.06641802498653049, 0.21744175197967644, 0.06489547396238403, 0.18040220457998496, 0.05938087894205174, 0.01956959085898294, -0.2883627062675275, -0.07179474023851391, -0.09356390378003235, -0.11079307135478798, 0.27602412837038076, -0.12631827518201125, 0.16202257687235894, 0.034844966868206186, 0.1510385416940859, 0.05916937472989398, 0.08899823164135028, -0.00943774647897591, -0.20056948614483902, -0.008953880503494953, -0.06761153372879654, -0.16158934362343844, 0.21255104160547772, -0.18409945835582547, 0.24302645886170737, 0.26399908975783454, 0.1508670693664015, -0.08172593623139549, -0.21202640742844925, 0.1475986620353675, 0.005285433197222919, 0.20154237811974626, 0.24405689980795225, 0.15719665918901293, -0.1054630096844662, -0.02231211042123021, 0.16175720391707035, -0.13275396511842488, -0.12173824775423768, 0.0038574904679208447], [0.3630437783209564, 0.13489996538602686, 0.0931860353301023, -0.25211809816988673, 0.07545733458421246, 0.3036163060964938, -0.1982511383119475, 0.06959274408576026, 0.23267802267017204, 0.13499331872453812, 0.11475825147754057, 0.1469516957655317, -0.06680197359845025, -0.06979382497536572, 0.12751430012828424, 0.19818935661900022, 0.18833069784617767, 0.21942374976618698, 0.04665550561031656, 0.01562063941858938, 0.09489593736031449, 0.08367508779500031, 0.17937164313687368, 0.18651741012306813, 0.21290005005388696, -0.038496023950415084, -0.020337054656789855, -0.1813228999703353, 0.10875293637890573, -0.304937381429784, -0.06090996439565015, 0.005129079039081777, -0.1556591606988399, 0.10632202715999163, -0.10856370967872678, -0.16965208541400575, 0.2114100238756026, -0.10950128505592747, -0.208798664540245, -0.038332723421370125, 0.08358825541944796, -0.2373329438569911, 0.07810813736822347, -0.21995188507091598, -0.23680673449443498, -0.048775896240971776, 0.09609924564859675, 0.08726549022779671, 0.09077314184647502, 0.25262287391328536, 0.06985269078187402, -0.11100434696761832, 0.19693852425864525, -0.03770091436124803, -0.09678402612794991, -0.34723412545669513, -0.25990426369991304, 0.1937570321228163, 0.14633714495543956, 0.11732588995172365, -0.0894616764927663, -0.17120711303359196, -0.14868319114696266, -0.06725450911494257], [0.05612051373287499, 0.08641682093398237, 0.06714256260239117, -0.11366991866474621, 0.20906004180548018, 0.2260442964678032, -0.0021349098471838725, -0.027623886521013608, 0.058904903671494833, -0.1455267741871622, -0.12928810007855765, 0.129976378118372, -0.2116238406984305, -0.13251092784158225, -0.16847940622292612, -0.25193201984284885, 0.15955661169568494, 0.08481295088037824, 0.0780667240089834, -0.27817425143383206, 0.0606957923401922, 0.005383265247313, -0.21923126558899791, -0.008207158005171274, -0.061646997690801, 0.05577317064905942, 0.040090797230811145, -0.2547875704355295, -0.11957301242247341, 0.11083177411042097, 0.02416406665708662, 0.2057157207559085, 0.09218669577953428, -0.1864234537283272, -0.2621729025551295, 0.08808163008822936, -0.3552338954816927, 0.03427761024486751, 0.21005051756028975, 0.03385708743070134, -0.11452189539493114, 0.06218225480439332, -0.0763568519250829, -0.004488020165463386, 0.25976515627751, -0.017288349489792156, 0.16092938632729492, 0.23369374198990978, -0.07961298621834854, -0.23034403593289784, -0.17793414314668757, -0.3103409025818951, -0.15790911775181385, 0.21305511335345834, -0.19997350184156382, -0.1348769517561873, 0.21987905889738063, -0.31199724260349065, 0.08312368637112427, -0.011521278314652222, -0.18643176088743454, 0.021228620377219398, 0.13522906451799988, 0.19129465108182034], [0.12067443303381661, 0.17560207415345827, -0.01411292469026247, -0.12949129869792936, 0.09709738267387577, 0.15491077831955513, 0.30949172750541615, 0.00028190388293048254, -0.14294711948747638, 0.20456992774954613, -0.10596894020993013, 0.27068008304687075, 0.14470076203282284, 0.035254690710419326, 0.07142088136607103, 0.11133684565684561, -0.16377109030235507, 0.12158405717575482, -0.06142430028327048, 0.2600640562053537, -0.1106582227472424, 0.2502945887378537, -0.011055793892433679, -0.15725764968876108, 0.31213757861322594, -0.11546507195755108, -0.12567594482231217, 0.24481298692380227, 0.18533832185066187, -0.0010078094874592, 0.08002706297476155, -0.06764621486104767, -0.10241077832716843, -0.08844901266756884, 0.1327496969117033, 0.12639555025120555, 0.06856837951537396, 0.11356276974169999, -0.21263839290626269, 0.07217024198394907, -0.16482884488744529, 0.021955801038031214, -0.09324226462792586, 0.1387410189807153, -0.03260018281556896, -0.17155879853008218, -0.0992022411326879, 0.13180504458114298, 0.07988632969468226, -0.19327402524599965, -0.18535049293344585, 0.07744834704061854, -0.25024088308764514, 0.09224859253285841, 0.07656454955352882, -0.3208562846382817, -0.23292080296647466, 0.24217087470128218, -0.055126400261214945, -0.05309560025320513, 0.1581102778560531, 0.21879358065638455, 0.2449163596014638, 0.10753758182329604], [0.053846996361057636, -0.19793385830476712, 0.1686324816504742, 0.06589445270344484, -0.10894089344690916, 0.21483335291523012, -0.20331941873846854, 0.01573120982457289, -0.2634850018052213, -0.015889672750326263, -0.28297830932433216, -0.22373240840297995, -0.18946968077550716, 0.1290476898909821, 0.17152703090043017, 0.0334951295358823, 0.24045923563449303, -0.03959594874188875, -0.023715801337439904, 0.15946377499497907, -0.22020156718552364, 0.23780524571125805, -0.20927029911717424, 0.19195426878438826, -0.30521569831622936, 0.26249364826546967, -0.0134901353182327, 0.2657952195406746, -0.15694200215201612, -0.04582462233053189, 0.25582931730935043, 0.0001750040465165953, 0.13327076252716363, 0.1324441445759148, -0.006793093819490163, 0.11993208343654203, 0.12679192184926272, 0.1621217723242417, -0.3410437833360677, -0.17074613507272957, 0.18095775170066714, 0.26091844180658696, 0.0011303933932080598, 0.02771115004465123, -0.08521496074541024, -0.3145248787741627, -0.03117350269059754, -0.06556720533435585, 0.0073882374345538475, -0.2694005487099115, 0.26261210901454457, 0.25536891247548815, 0.1620524771406016, -0.04144978923340248, -0.10609585445720095, 0.18726507365355927, 0.0741243528242156, -0.19947601861338532, 0.21417774225962283, 0.20851893929740442, 0.2111101881612073, 0.1273448955491536, 0.12015225640913443, -0.037883774270166655], [0.29884143151289844, 0.19008615493323078, -0.31862776059032377, -0.2970018512340704, -0.11896752339637069, 0.1478115084044476, 0.2638613294298551, -0.13485303906629642, -4.7609812739087115e-05, -0.08086540887541728, 0.24788308075730225, 0.13656504226047772, 0.1740919762162819, 0.023224258030515667, -0.03225204899936302, -0.11976348055605873, -0.2601622908387084, 0.23944153825685682, 0.21082438940062814, 0.21905093089324634, 0.30337797188011756, 0.0010413887587755366, 0.052425292711248836, 0.1995199112165223, 0.13892445932169667, -0.11660396337436282, -0.045277468530233816, -0.19490722804549687, 0.2199034805045241, 0.14968104636710935, -0.129951834154445, 0.11463308536345398, 0.07320209952676368, -0.09757743801231963, -0.18314281357485607, 0.05846376506154755, 0.02848045891937697, 0.13623613487755457, -0.022815299907633837, 0.20022815803407862, -0.03320329200110516, 0.06618481546151958, 0.20774501376118543, 0.03634409073209651, -0.24190971943785347, -0.22745905859538793, 0.18858949743683856, 0.07422308984684048, 0.11604610235807523, -0.1973897395704629, -0.2836522769217105, -0.2973928827440329, -0.018656445915921843, 0.0711742858880149, 0.02639716985847804, -0.08418813181632749, 0.1974522039632087, -0.1252853080635812, 0.00512061793942163, 0.23843659988501853, -0.1102585110000062, 0.0488835079222437, 0.2173810547255989, 0.20055112539402303], [-0.12569617131179353, 0.33173861801489823, -0.07663856389662951, -0.2833265168425858, -0.07228803559215684, 0.2532393327059932, 0.05156698396317146, -0.2070960924617726, 0.13288379433034828, -0.33108921537013014, -0.20714735085967215, -0.13162392609146745, -0.2958581980010866, -0.16193263367481123, -0.38522966642848, 0.11092443578129725, -0.24736399235793843, -0.057335132579675985, 0.3087005827487353, 0.10594520804614707, -0.0603746743307129, -0.06109822019438751, -0.2744888679107117, -0.39499456062341143, -0.24700672485176753, -0.20681770819121623, -0.244177234087398, -0.1717554308163543, -0.21318508156716565, -0.13362691527475432, -0.22756259427150974, -0.17122113809699713, 0.09816473851823772, -0.05337840841796148, -0.5417408195481942, 0.013500097953842707, 0.21391928874861527, -0.4173377811821026, 0.26987488692076217, 0.28432620470509423, -0.2617672139048981, -0.24459879908212698, 0.17391637239162294, 0.2527032492819774, -0.14014197595285674, -0.23856305467582595, -0.22681415365047614, -0.08137045880834289, 0.152707615348436, -0.19030521711686094, 0.1705344434217607, 0.24622103057081687, -0.23480829224500108, -0.3125576697946335, 0.04446159826408974, 0.14447487399819445, -0.04391770216829152, -0.07471325251279123, -0.1396130807882106, -0.059671944763866135, 0.09076024773500621, -0.07487226831836077, -0.20232503256036566, -0.14448718176102773], [-0.3918425387527513, -0.2639798727654958, -0.1538318415874506, -0.03167854610535946, -0.439204963166873, 0.242255645495658, 0.020921486164505416, 0.27002469852385713, -0.09911479039086141, 0.0607003509978437, -0.30066944704584536, -0.05232947052094299, 0.09369540266545458, 0.12365636637733833, -0.026872120101743998, -0.2659036574129445, -0.09931372012282705, -0.05649237794699229, 0.09381214970098457, 0.1756752768089595, -0.06165841941726253, 0.31741818980175074, 0.18311741922835387, -0.14676651827624815, -0.22273922924987438, -0.1299722085698402, -0.17276718648449252, -0.2750198768237762, -0.35174380670189825, -0.2119243470649855, -0.2517202353063638, 0.2837358875599941, -0.348767304272514, 0.07293321846986478, 0.017151895344566723, 0.4572950401523193, -0.22485392408407218, -0.131367136390457, 0.39207115951727184, 0.14341111468262055, 0.20422438782370544, -0.18942516143843202, -0.22105087566606618, 0.19511357622269695, 0.18334415403783694, 0.046533049073665185, 0.0839028403135571, -0.11829199074617387, 0.17418489619052133, -0.1628739958851465, -0.05466832795464056, 0.0331180170757214, 0.07451269199769789, -0.24281662880972885, -0.35987040208176735, 0.03944362726238448, -0.09687465330821406, 0.11066776857135435, -0.24349180616425312, 0.020753920304663345, -0.00629147842377793, -0.24630797474498634, -0.07449636866434779, -0.1382289806337192], [-0.1899446669831767, 0.22762161548696608, -0.2292391821885123, 0.08560074123462157, -0.22257794804550177, 0.06609676262302495, 0.10644889848863477, -0.09232061280912564, -0.006126478787240239, -0.13164514043211215, -0.1856020978024942, 0.19337660526881956, 0.2577859237451969, 0.26262846772758175, -0.21773092943918826, 0.07710249189954736, 0.20447138092534345, -0.14784229014773978, -0.23461030156985455, 0.10043934221996946, 0.06586195986199354, 0.13689659256666775, -0.2606096024159115, 0.15033566233027634, -0.16030862525071624, -0.22785142821356696, -0.17782730813058337, 0.2242074062819977, 0.06973252726558747, 0.0865319423554871, -0.06829743641562132, 0.22707730755994207, -0.03525841700956537, 0.11421750584712291, -0.04465954297683144, -0.16527213657847895, -0.014970296783647108, -0.1051704322986407, 0.1402615129531096, 0.007411277179993802, -0.25348720651055245, 0.2114624499080164, -0.028739626664609014, 0.016483739307732902, 0.17710348577177723, 0.07825501041446954, -0.11035107140576272, 0.2553788292093384, 0.18702867050484323, -0.12700390659298624, -0.20435736269284657, 0.0691022263462802, 0.06934998804712317, 0.05098646410829215, 0.26742063659306503, 0.10745994771741364, -0.2115044635769598, -0.15714893847205907, -0.07164817603253201, 0.20592672600871004, -0.30510218141796586, -0.10574986090607379, 0.18079019917613712, 0.10468406458027708]]
B1 = [-0.15761735691168904, 0.18508010112440798, -0.37990515211686654, 0.029979900461790242, -0.06535470955235452, -0.1250303926406021, 0.10209036688240107, -0.15601771229509523, -0.17672674925566986, 0.11782805376656486, 0.10987076216504206, 0.05467494799787358, 0.1966224316901674, 0.061372330176447255, -0.14856146026038186, -0.10161545752603568, -0.09125596304486595, 0.3256165523043613, 0.16594621687526281, -0.055719417610385895, 0.14101180956228537, 0.2515133477713131, -0.18124914078336316, 0.06113465021924553, -0.05589667051357778, 0.06375937306876679, -0.3480841126456989, 0.17003919480734514, 0.15296773457786547, 0.08761215229550748, 0.08631370581156028, 0.2793562324699621, 0.037424520282105266, -0.23734039241978022, 0.14560989857774287, 0.26763376174764475, -0.049896832578229196, 0.23070296409495378, 0.19365577062264674, 0.16443111162358087, 0.015623822959179762, -0.23185798042722164, 0.29960116804047593, 0.16561977858011603, -0.2455708105454243, 0.29315310362047814, 0.35554483096899914, 0.15352589396746052, 0.10786180274559966, -0.1061658816136636, -0.21790190693452846, -0.034699544406015706, 0.30247670152485195, -0.131294230043335, -0.03114988379325073, -0.06974596434204508, 0.080664309402858, 0.1941454275354281, -0.0643049962595881, -0.12858207113846917, 0.07307278021022101, -0.04226899991838637, -0.0015801305680628126, -0.0901338050095935]
W2 = [[-0.24544436265156402, -0.23544493034248562, -0.17516884829653762, 0.21739625326115386, 0.09308054708352416, -0.03807220159562953, 0.05495145366789268, -0.1127307146129233, -0.2100774395709117, -0.10306749933235632, -0.06162088706843297, 0.3251315798087349, -0.25095313245286094, -0.0038545128011300274, -0.18114038158005985, 0.17240856929695966, 0.09228919603664654, -0.006577658746141095, -0.017715317363486475, 0.03314043818805542, 0.08789143440297296, 0.14323037374665126, -0.12545621255878248, -0.16635042728891863, -0.07345050961480891, -0.07189617165106243, -0.0805506485123492, -0.25647675585264146, 0.10986927322453269, 0.12613487348757585, -0.08313172080267701, 0.15115088895826015], [-0.05959805490473595, 0.02747027285477479, -0.16341633473617373, -0.14199204066862117, 0.16660675105589254, 0.23060964880824378, -0.024511822718937638, -0.1408902432470559, 0.06395257706986357, -0.014036139358801951, -0.2860548801793948, -0.1202826733056176, 0.07802471825587376, 0.10027096293511893, -0.21661509427028394, -0.23160018199340096, -0.1148771751279803, -0.010915200630443971, 4.206213249881758e-37, -0.2863233687923812, 0.14452442085562645, -0.19373528680944488, 0.05679688726856907, -0.2027475058008653, -0.15632726444661918, -0.26781964458514357, 0.07974619341495832, 0.1566773756636808, 0.18311470194980992, 0.0046828728921431894, 0.13154803956086392, -0.14718162699311677], [-0.04931869055080594, 0.2889280950182796, -0.21406685614245363, -0.03042328162592853, -0.008690845519354578, -0.33985076803722075, -0.28104987301241496, 0.1568048266793129, -0.24757268578008249, 0.08192804113399707, 0.2516854404129831, 0.05859099527588863, -0.5007562278671918, -0.26234762959474556, 0.17690896064390024, 0.01536189987166656, -0.04292215461205892, -0.0901222109926945, 0.011135931490763425, -0.19090326371160338, -0.00803240996922417, 0.052264077919197696, 0.17672653305918248, -0.05472046175325833, 0.22699744439294897, 0.2111177958755578, 0.26194399282397735, -8.469262765703366e-56, -0.19569396912372014, -0.08952217255650537, -0.1840769485888787, 0.03554903432758812], [0.009799137005134044, -0.12734474399124363, -0.2372331627130318, 0.27784447826870395, 0.23425683547303125, 0.03263786693192608, -0.14861073245685283, -0.08899606457656903, -0.20015425689834565, 0.18179534634197497, -0.18398953628210798, -0.08609365837054726, -0.06997248043223586, -0.005917323467444428, 0.10030511907910512, 0.14838450253043095, -0.15831014912522112, -0.33001651180836206, -0.13239626058028967, 0.2336478264543494, 0.04150554311741614, 0.03512679642686724, -0.035359818582115725, 0.06305561970614923, -0.14149815977243765, 0.23919555720877447, -0.19309517280011146, -0.0684979949228838, 0.019660491722119273, -0.06703999872065922, -0.12985714046022653, 0.19181859052867695], [-0.23423758903094746, -0.042468759083245676, -0.24549039196526287, 0.03477288756298634, -0.07812791855187477, -0.018506431315211156, -0.12870694122710552, -0.15890939034874155, -0.03106305503426134, 0.011696573028650743, 0.11863122495595008, 0.3379501281845223, 0.1551217862906976, -0.08989852137902142, -0.1595216615989969, -0.12708185080038978, 0.08736110062885033, -0.2538151427506991, 5.734009733883344e-83, -0.08975886129943138, 0.1255661093923661, 0.14900554943429664, -0.1851318648480361, -0.19649666483429393, 0.14406108881403656, 0.03263316095617906, 0.10399686935463168, -0.06933657648144, -0.11783440735706505, 0.3015052118085542, 0.15445239106447708, 0.1675476663091104], [-0.08049445663224788, 0.05122488389218512, 0.0006171024831748531, -0.3144365269025258, 0.2086573568443026, -0.18642343491553284, 0.23966742418057616, 0.02834153386900099, -0.1493708562869686, 0.04864699637826057, 0.16533894654874168, 0.11048338844966585, 0.19465697212593594, 0.05553386247414762, 0.07892310597127551, 0.19037511641576546, -0.16727426651184993, 0.031001389159407554, -0.06031428862414106, 0.29017395129635115, 0.22048869877001442, -0.1504842816287911, 0.13308900742690125, 0.2057852141778903, -0.12906984446338599, -0.02348566958853706, 0.2149313409182292, -0.1830434675779261, 0.10823795307225621, -0.08407574072366826, 0.2809744132035775, 0.21570009557007921], [0.2180871238687468, 0.02800046828691391, 0.18472786599569974, 0.12627520540522594, -0.04181447232546649, 0.1574841006318328, -0.11754333511700543, 0.05758756660980164, -0.1173859901429023, -0.39668804431854426, -0.13913211600146647, 0.09571725791386294, -0.13510965040456507, 0.08369908885917736, -0.15843948349417597, -0.07396501376914694, -0.00999625679690477, -0.04369717134453133, -5.7178739386326415e-68, -0.06113030911362091, 0.13382630948212595, 0.1007221060220429, -0.16222458604254264, -0.24789413663621748, 0.22818053882840347, -0.36989624983120195, 0.14777266967184627, -0.02145178765616279, 0.2122018888039682, 0.1586615858581634, 0.25306869930307874, -0.10964141294989442], [0.1853388181200871, -0.02980984565720002, 0.047572738701060935, 0.049518194116062626, 0.25659992416762967, 0.2111896167634233, 0.2511726941270818, 0.02456765963762862, -0.06726098804308123, 0.16681638851686587, -0.11335389194289106, -0.19071827976389505, -0.21101647871741092, -0.2595646138803851, -0.0142080326125755, 0.006087161480208672, -0.5550449535939777, -0.40036276014333705, -7.990499645947832e-37, -0.18181472126947784, -0.23325509793160706, 0.19690150899145584, -0.08765085791461723, 0.34712716850338277, 0.007292409738127356, -0.0658247757505764, -0.043345347224863204, 0.13527023912907665, 0.1790488444112705, -0.019280830976458028, 0.09583126215552057, -0.06541296781759422], [0.09507639367291147, -0.18246820119807422, 0.23872802637716312, 0.2057495504662369, -0.007563935052426244, 0.0775471452273531, -0.1477189175979419, -0.1853364535522191, -0.22474764755165327, -0.016874791662203494, 0.12756209266116378, 0.008203282143791991, -0.1217859463325301, 0.31884306164057025, 0.27222518093029074, 0.08843429836806721, 0.3306525202611508, -0.2828059206956295, -3.5467181950297225e-75, 0.22357839552153333, 0.2989711735968519, -0.0790942047637691, 0.12328182364044243, -0.15809851516891732, -0.1661198306330332, -0.09727706760554806, 0.12023021769222286, 0.037831295472514986, -0.08662284386102628, 0.21994744697794014, 0.06373064701939372, 0.05456088667044544], [0.19988378781414315, 0.2487458667328408, 0.2288135245651124, 0.2634421973855619, 0.09976897530688264, 0.0018309715757564924, -0.2096520134172268, -0.021690896007495075, -0.08732983038745075, -0.22264397557233392, 0.13460126340230277, 0.0023921303924546128, -0.2768495673777378, -0.18282677429951194, 0.1456881695692311, -0.19159775153166542, 0.1586825219816128, 0.007589738345674791, -0.015580126747867303, 0.008797433256365226, 0.11323536693003977, -0.07254065933878545, 0.10108768390159158, 0.04813245644023576, -0.08255226738243555, 0.19747595495611178, 0.20149362782439334, 0.04951943670969622, 0.13303757913157266, 0.04884229534153983, 0.13433664478556745, 0.1639267976209128], [0.026499224973309518, 0.1037722716675854, 7.169995805491317e-05, 0.148960753972003, -0.1503372171967605, 0.1976790138900997, 0.16039750210725956, -0.2432709478867969, 0.15637845591065813, -0.2055251027200385, -0.039105609805814415, 0.11694004518752381, -0.15089332796900443, 0.14345677926760653, 0.1830470825407481, 0.001237806781346969, -0.21947141832854605, -0.2459401555701928, 0.03488735011315433, 0.25221488934436054, 0.08321526425026052, -0.08584107033163503, 0.0016363516949726422, 0.02942366665628443, 0.19950914509606882, -0.15874113116809757, 0.09880059687131525, 0.1384956352416868, 0.2046460136262506, -0.03962564425922698, 0.06726412264590652, 0.2877173007106489], [-0.1845700181776543, 0.25091474437907907, 0.09867005201944622, -0.23217952001525066, -0.08862911079869405, 0.05309520960600079, -0.13852436705144755, 0.02577605888326481, -0.1482758489689885, 0.12799595323740337, -0.16128542673434484, 0.1874568441427159, 0.16357910044454893, 0.20573253408000053, 0.15947928489575583, -0.17930354490875045, 0.08802867868948727, -0.3037373531506605, 2.833030271338082e-37, -0.04809976939653416, -0.004945976693027952, 0.059307182549117196, 0.0449961368950878, -0.0575359157338734, -0.06731144660251079, 0.34917371056689195, -0.06878648736815626, -0.04970974161407129, -0.1881696569147709, 0.20267712184993628, 0.06858210120597945, -0.10335299840539867], [-0.20526921009396779, 0.15299784066178054, 0.10065986014163292, 0.0030941938027598563, 0.2525879436027998, -0.23121104795061195, 0.07700901403712385, 0.19205771285165785, -0.06100893601486368, 0.06974857903549107, 0.10319852759326802, -0.1405310229168611, 0.1319404978959471, -0.09909069602946995, 0.2702984725731002, -0.10862066586936817, -0.20209133369114934, -0.12716615762697012, 4.446114392725323e-71, -0.10208390256859386, 0.17202100272741083, -0.10538751330644447, 0.17636154215256025, -0.11224621257744904, 0.2690299437364238, -0.06699306696526694, 0.10815583985718386, 0.12972919623150597, 0.09088094474097339, 0.08324532046389756, -0.25062624637267616, -0.09626637506405383], [0.12031774157475754, 0.07651628557160962, 0.09532611591964335, -0.015954103654529282, -0.18211124696682202, -0.19283858685838406, 0.11147820406421596, 0.04586115604246837, -0.1208943043142855, -0.11681390142283404, -0.19169555699942994, 0.02604561836945784, 0.010133600224053829, 0.12823383165216876, -0.07141403266432694, -0.0020176110193476813, -0.28952728290457996, 0.0353799793423443, -0.055529229094936496, 0.010820275147738005, 0.13520476834822936, -0.05066764809305693, 0.01574637005006078, 0.2001937685334646, 0.16451769120317786, -0.09731307661312637, -0.01378511137617292, -0.17119920349316858, -0.1448558442065395, 0.3018683873858434, -0.02323239957091363, 0.047742869802380565], [0.045769497166892215, 0.12735929501410115, 0.0036010691239574876, -0.19984768705519412, -0.050551681593265854, -0.016663017740713257, -0.22105492474682503, -0.02994881377247505, -0.24851949884174251, -0.22864987030794706, -0.015225325377699092, -0.19813754261856714, -0.0023026224015097515, 0.04108746963778228, 0.20503595489267787, -0.12900419415796488, -0.1662663686342625, -0.2660754904399606, 0.04074552557714875, 0.12006047124122564, -0.3494581270221412, 0.10695395510169864, -0.23226823451323525, 0.04431713293685039, 0.12921655343049457, 0.26967236294695573, 0.08996170026092014, -2.685369111321295e-55, -0.10587615620312235, 0.18223742290566744, -0.1956351094257024, 0.208564420053391], [0.07952823047621163, 0.1327776982913573, -0.055564801136316164, 0.1255480836079857, 0.01702681394395373, 0.18365428059914096, -0.331167284670693, -0.1547356190405763, -0.07474251749789475, -0.1580337672373482, 0.21167667949531732, -0.10684925218192465, 0.2601096800467541, -0.04792238181686436, -0.18406562990998618, 0.1372589061781935, 0.1755307660573821, 0.2301777726465021, 0.009403856392884423, 0.16034953495540363, -0.11628212105070349, 0.25041275727868273, 0.31421604981521245, 0.09522571506414733, -0.16376100875624683, 0.23893070263549773, -0.18039344242166988, -0.22724189037240702, -0.11526671783610765, 0.1239203533132863, 0.19466672884275416, 0.15435360967566722], [0.09926450656047735, -0.0278252895437927, -0.08941168211125514, -0.0249338495165721, 0.2519359673375553, -0.23362551172273444, 0.16487241679318562, 0.05052401338191667, -0.0485178027560207, -0.14994278735560324, 0.007852646806410651, 0.17156312389294062, 0.1980440776284109, -0.0622735000234663, -0.09044703785379597, 0.03812654737824817, 0.17888079930108305, -0.19930917334147394, 0.03869798179989206, 0.070976424647322, 0.15550255224896575, -0.08618735192053913, 0.09574599423409993, 0.20630209311716605, -0.09679849764141077, -0.12713433527249066, 0.18903230765703583, -0.14599171265410427, 0.14068467536787202, -0.09369674030530745, -0.08477370448787873, 0.19504013492385489], [-0.011144174915686608, 0.0349016681467149, 0.008586009191508086, -0.015535695273433299, -0.13487883633341463, -0.0694534939687061, 0.2610071382647256, -0.07300029185994766, 0.09491572907464318, -0.08460575552320287, 0.141847645547949, -0.16474317561175938, 0.2716753468820504, -0.034661057841896076, -0.09603768509307076, -0.19571501031278676, -0.19259307599850578, 0.017386107089316486, -0.08024879269801878, 0.24446833880868393, -0.009782168032360332, -0.1369856528993787, 0.04231635683776435, 0.13912744539304864, -0.09300775677045307, -0.16172343822297525, -0.27510600570618715, 0.041278986975110565, 0.05979492909288016, -0.12264299663754498, 0.24407459259316855, 0.12837925963073643], [0.19513536439499338, 0.13625144620335788, -0.04393444292875766, -0.30805610348493173, -0.13128232386550498, -0.1551029536064538, 0.06615417164444015, 0.2828077905085526, -0.10048714538079467, -0.10732879143626967, -0.2234119192917513, 0.31842725624850254, -0.015945980749463906, 0.0746520065672693, -0.2824027880022309, -0.33657839790728744, 0.1860538155586466, 0.2648693785029312, -0.0021776268849257384, 0.4133791380749525, 0.06319776334638613, 0.20608595085571002, -0.0733296361700811, -0.005696093924674769, -0.06164427312311195, -0.014983690850911498, -0.05090766811015346, -0.3258215079551679, -0.042466816092601, 0.04586272106549533, -0.02346850991234607, 0.013544426949334507], [0.06514113330417912, -0.19121345633862755, 0.1381718764551057, -0.13218722480494366, 0.18914204932544285, -0.22330991909103445, 0.13112844829389012, 0.14477498385545257, 0.14864838372167324, 0.19507092730739567, 0.1638025578320377, 0.08102129611035673, 0.17789412407679026, 0.03790975509488797, -0.28560644288033643, 0.28331096193039734, 0.041892181428387784, -0.23922818531748516, -0.07006400664066419, 0.06423026218406842, 0.0021049690641639224, 0.0984415823073493, -0.1928359700787775, 0.15583787218668035, 0.20790798105061012, -0.009961079264112922, 0.2951174282635636, -0.04896297714061451, 0.17770733885442785, 0.07721540582433543, 0.1367749259821478, 0.14849113273565076], [0.23675573657609167, -0.0398990029420579, -0.07831346528791681, 0.02012776549771287, 0.11227352663520353, 0.187240984468827, 0.20149813843508865, -0.04676749352593388, 0.18391373755141097, -0.2657859099999597, 0.047539715672303896, -0.09676731043001258, -0.15579565355249134, -0.050909290420936754, -0.0013932444984505108, 0.12202677943840527, -0.03368297187089062, -0.04851023299147157, -0.11376095272336412, -0.04269055370533777, -0.07037278750011147, -0.21031749379736972, 0.019304679191139727, 0.3082785579020387, 0.09786423969792882, -0.10379923618267095, -0.05174940265940277, 0.17325660456664665, -0.008151664839349164, 0.044142208626280634, -0.21327540533138106, 0.10532468210293715], [-0.04380120386263514, -0.005833949536270924, 0.1008236615079873, -0.14465397526823368, 0.09378873282826547, 0.07659176177943199, 0.1984437923259708, 0.1604508680485094, 0.1882033083589909, -0.21838492638156132, -0.11787586105699725, -0.2551434015343948, 0.06930050372765932, 0.15605577944536342, -0.08633166013865747, 0.25094616109532125, -0.25702896589108243, 0.25028497194990057, -0.07288507861417534, -0.15045716354008862, 0.006225961283889617, -0.20873318007730032, -0.10749866415679363, -0.056899564374153194, 0.19133261786407385, 0.045874583456638036, -0.12091656002959784, 0.014512683531583553, 0.06568240702879279, -0.19264972319659315, -5.741863852381802e-05, -0.2193019168924282], [-0.14114993865491446, 0.13435665287804213, -0.10496546452700718, 0.1787424351519076, 0.14282168477733365, -0.23057836500087633, -0.06251385191242848, -0.08962299618048591, 0.1724895154589489, -0.15715500825467735, 0.20566839059358333, 0.06296798414143996, -0.4108861359357152, -0.061361953001648734, 0.3042901204694313, 0.10201786158916488, 0.1893057174075249, 0.20479617594802832, -1.039408973015124e-59, -0.31721560338257954, 0.0037625668966688565, -0.1228583779200701, 0.2044393376782259, 0.24782816049640338, -0.03660928860411607, -0.07228323613634992, 0.23585658835091988, -1.1048555832406009e-63, 0.11208671188859803, -0.10455258148621228, 0.1525592330659227, -0.20632788895276358], [0.03420188324193601, -0.011350478054314767, 0.030440741035856315, -0.11172011922666503, 0.12299934763168535, 0.1834435733277005, -0.1445956926999301, -0.16647515647341776, -0.243038620649229, 0.054176118415021, 0.07070872603016665, 0.011895063360603317, -0.10728692068231893, -0.076288303772292, 0.07589197508075322, -0.0014965135719167395, 0.2253256325989989, -0.12056489241206732, 0.07143174242664697, -0.044414262537263924, 0.02191434172362999, -0.007334053379883132, 0.053543277624971235, 0.25081947353178796, -0.15562735774185346, -0.1909342172323812, 0.12921846451254387, 0.04663076338460331, -0.13899867581125638, -0.21703759473979026, -0.11682002330330592, 0.21685706444664787], [-0.1662504942442851, -0.10261821426319247, -0.1671778253708766, 0.19779081508725077, -0.21162719389877013, -0.014318168974979397, -0.34405092565939793, 0.1642093440003871, -0.17223535699170134, 0.00047045174159096457, 0.22977318717526923, 0.018854899509316018, -0.053012682242563294, -0.12924680399605304, -0.02305913688198986, 0.0725852226968882, 0.3392253227778637, 0.2928510612619634, 0.007967327969546632, -0.0007286109935712149, 0.02196588102472479, -0.29441294976066074, 0.01405636515233891, 0.24158752839870676, -0.10289012082827141, 0.09828528216913046, -0.06442989763557368, 0.001783316437505604, -0.23494047300347876, 0.04795956512050918, 0.20417215864487576, -0.02574093433216356], [0.05954804236246361, 0.16809159350257874, 0.1152348857739931, 0.12336807328267363, -0.03687985305543878, -0.1586669052645709, 0.18901348763820253, 0.13754607454844361, 0.01797949313921606, 0.14757612664527853, 0.05059155898255435, 0.10116044850285098, -0.4198193090831262, 0.10265712854010027, -0.114337189577105, 0.2081625220408951, 0.09653068988977806, -0.003603616581259627, -0.19786186421987134, -0.17023887822975153, -0.45818499611779395, -0.20096827261838024, -0.2797256876877732, 0.2554806877738341, 0.1164543041595099, -0.096208545677107, -0.10642711491779473, -0.2418686422068929, -0.04663143483995919, 0.18973365179584864, 0.05194214558530975, 0.09458634643577275], [0.2330013485645936, 0.18997082779628535, -0.10977676893605835, 0.29389267813191117, -0.15413221266894972, 0.09143144134698661, -0.09058594634535554, 0.17946832554844502, 0.10528597855368753, 0.09852326568953582, 0.1770455907776667, -0.08039872213698451, -0.3241699052749625, -0.11210539051652466, -0.14418334969315008, 0.13596516286902868, -0.12889426237383245, 0.2894805941498376, 0.0407032763369287, -0.01876967472166553, -0.14798155951198824, 0.1799076753681168, 0.182648036990497, 0.050785223695274925, 0.08884005385556905, 0.016352541881993435, -0.01993707973885281, -0.008356952528310311, -0.08070893812428738, -0.13266494407305074, -0.14508224874699635, -0.11865111882808788], [-0.2907402430322489, -0.15982568176380382, 0.1524536715910068, 0.21532605585893358, 0.24519663753694826, -0.08160142137097402, -0.0011511456365374082, -0.04973048157554042, -0.060553675940082305, -0.36469978495538397, 0.13183645010786427, -0.09556779513564855, -0.0659471976084962, 0.04179266007518091, -0.08999542874596525, -0.16987074819176176, 0.14383539309726395, -0.06976031068230218, -9.898977430872082e-41, -0.007582712431824923, -0.2893219742188522, 0.011835404322974084, 0.1969663235222192, -0.06111154062904035, 0.012564927999975928, -0.26327705718079963, -0.15977094055951366, -0.28892615099173313, 0.05109634286423618, -0.036532936027580246, -0.11756918690258751, 0.2640581292456384], [0.09222320561800833, 0.08988761135850262, -0.17328896731672683, 0.13081894397717064, 0.022197559378280895, -0.06295005748671231, -0.1457987704009281, 0.09959121467483824, -0.024218301578992504, -0.29616456123461626, 0.1049174365093877, -0.004153696411078594, 0.055904542727482916, 0.08061806887533751, 0.19036775400884343, -0.2708928761767475, 0.009054730580711124, -0.16116063103085512, -0.0012050067593646152, -0.29615030157986527, 0.11141532533481384, -0.26300782435256104, -0.019663044879386776, -0.09006430671275809, -0.14361413104642967, -0.503037997075777, 0.14617516358058769, 0.12528171673491367, 0.185876244106753, 0.08913164016571593, -0.3121362881656794, 0.19468991209973704], [-0.0466229457017906, 0.22116902744563713, -0.20106635823738433, -0.0048341497795414395, -0.1473583622576141, -0.12496088016614511, 0.19997346708670893, 0.013022906054457814, -0.08522320600672696, -0.12867991729447556, -0.021728036955266584, 0.14750225046849683, 0.19814003533699465, 0.18262905943714175, 0.18038770433931298, -0.08289153049060936, 0.05541669666420277, 0.042480205610506395, -0.10220552028570101, 0.17776839303485167, -0.22961909649496626, 0.2531280023265692, -0.04903322593025267, 0.14441698198987124, 0.1199056026436504, -0.1349496501522458, 0.06039705718254455, 0.020926354792687774, -0.23637214173332263, 0.046758233898248215, -0.09477520254811851, 0.20387920876957952], [-0.01670437356972593, 0.11076303288090603, -0.26068022157711945, -0.10602080326119238, 0.13274063372900016, -0.22384584685796002, -0.19955357312633018, -0.23068378212241364, 0.22434709113448126, -0.015290584116997491, -0.043644753417164686, -0.13454866767325346, -0.0959590616248861, 0.1051499739896379, 0.12318983904186323, -0.15374801361080165, -0.1737653654515826, -0.4751448608533295, 0.052027508142520835, 0.1505237077609172, -0.116486345900013, -0.2712060231052261, -0.24082703624964516, 0.24559294797224068, -0.019046044369450284, 0.16729456334401105, -0.03329935780801289, -6.321362195973086e-74, -0.17658909702621628, -0.13016256187325878, 0.04352038384087911, 0.15845382369933667], [0.09139821156023265, 0.04912752501940611, -0.13942510317815957, 0.23410607937598057, 0.18222539333186064, -0.14359555549473885, 0.28120101675824516, 0.11166808235339465, 0.041162281889587704, 0.09430326071856318, 0.18124421977706873, 0.07764881285937841, -0.21667247826120817, -0.11956130485518436, 0.26214892567565806, -0.12634905975188035, -0.11310900013481318, 0.08449648072009289, -0.03665440646107273, 0.039839595414712596, 0.21215675423000932, -0.14036256592845273, -0.24824418072014617, -0.1416551151217692, 0.21978260555952092, 0.01716872337418088, -0.08761148982505564, 0.06028378207665838, 0.1289789979322596, 0.07571463302240936, 0.2530721703738991, -0.12355967142472753], [0.086472798404614, -0.022726006374395577, 0.09175119365209254, 0.12647677233441165, 0.11566287298653478, 0.08943082765125662, -0.14042444902305118, -0.017159456270697183, 0.254969858729806, 0.17507700932083556, -0.22952834377659873, -0.1788062910357814, -0.11404495987756869, 0.10728801459348508, 0.14087939449431752, -0.17578528078383984, 0.01991978675202398, 0.009647630628403098, 0.08384272042424519, 0.04589079199933384, 0.014388395380313359, 0.01260679104092852, -0.13732191130984894, 0.012251797374892003, 0.13730714543804612, 0.14382694246084585, 0.02466192876830064, 0.11295898643264296, -0.19530469043296106, 0.042468820024394525, -0.23339884058299487, -0.032030595215175726], [0.12454009284627106, 0.24901141909466556, -0.18488957811577963, -0.10867684801243417, 0.1492084084631964, -0.007477546482043023, 0.0022310544412819417, 0.10727588014394919, 0.21052933058075232, -0.10452440581628818, -0.0691550412184824, 0.13594959442155982, 0.014801792824048953, -0.3273106649295896, 0.19101238398640769, -0.2315979275951461, 0.1978208076124692, -0.1636709862458197, 0.1601295896599799, 0.03496686677834509, -0.34945018195303296, 0.08352996522472914, -0.06618469917532305, 0.18402783631538247, 0.2816171181396577, -0.1104903724922968, -0.08101862947291627, 0.05395456646950022, 0.17506169801737828, -0.027677878667314845, -0.03804018714681745, -0.0062245144712249475], [0.1230137139464689, -0.2213476099832927, 0.009054775692619399, 0.1633560649662451, 0.1998983457933609, -0.18682597092629594, 0.14029849418352508, -0.030753834902890284, 0.12736741897249856, -0.1303208797260695, 0.12398161644334019, 0.02277557357499764, -0.01364360412701502, -0.05293782976076881, 0.26491744581952203, 0.20762146727306294, -0.107621866935503, 0.21542076807314178, 5.934000309209835e-84, -0.3917836281118616, -0.4615066361409402, -0.14483198103253356, 0.08227014144359757, 0.17159944008556738, 0.15947397944799313, -0.027429910736296904, -0.09462968416499391, -0.3440721236600028, -0.04555363759724451, 0.04898263100156821, -0.269176998989122, -0.0373513274629318], [0.1355586914239753, 0.19810968551761965, 0.40061950846377486, 0.10265404975162311, 0.2332867788164758, -0.22275559475570994, 0.23686084535977012, 0.1933931652928126, -0.1932605395859212, 0.04543888374474445, 0.09438955637420009, -0.065216221049472, 0.02453098458366003, -0.03310191259602705, -0.10376732225375541, 0.06132216597223803, -0.24288256175119896, -0.12306756817394429, 1.938471192395054e-37, 0.3026133689259083, -0.1998058730862852, -0.011474936988525157, -0.13044938665752867, 0.36395713039197913, -0.09727268747863715, 0.1577788312955976, 0.23308932472398508, 0.05366580948166516, -0.22603689855805165, 0.09538083105179537, 0.083804601312923, -0.08748155269623517], [-0.18567626113208135, -0.26468636486928565, 0.0708325264088097, 0.06955316862161276, -0.08065976132936598, 0.18042759301651093, 0.09948536098401953, -0.21939793104215038, 0.13907295842467973, -0.33679225870005175, 0.09880678406946455, 0.0871498495118668, 0.23088529622522788, -0.11757724014846031, -0.1716880593792071, -0.15553408847922268, -0.13546736768038792, -0.020032696099464137, -1.5435930181757925e-44, 0.07579798404129505, -0.4885640186890078, 0.18165117392681918, -0.03565134859192379, 0.11895419486937187, -0.14081172784036733, 0.02509848678220321, -0.19916355962894358, -0.27577724178916485, 0.2603787854740652, -0.03453781938899522, 0.03221170269041726, 0.035191735315239364], [-0.07794523520195043, 0.2450130605508413, -0.1276649006210956, 0.12831159352769497, 0.2835963093804829, -0.01270837548878687, 0.2607412841045025, -0.1821081938540488, -0.058450723006987, -0.20136624966653535, 0.16995549418766281, 0.23862400445003148, -0.15115789905462715, 0.018877489767614775, -0.09987968697635154, 0.07486501746738605, -0.04659599835907294, 0.3071141974223182, 0.03048854869622962, -0.19037644153499855, -0.18578933781970267, -0.15920152878901542, -0.1860327962493588, -0.08002763755573923, 0.22606309433636165, 0.014121765631068296, 0.037267988480460354, -0.23567836458357222, 0.1144996299285919, 0.08632867133348186, -0.20114843367914198, 0.0983637736867959], [0.044376125107495654, -0.16878368669410854, 0.09028901385126686, -0.06071841711367745, -0.08811151962312343, 0.19669780771335382, 0.3258112338852399, 0.12679625194817568, -0.016339935240843716, -0.02463383210772291, -0.049861370545411746, 0.031081323944734677, -0.20445063307735886, -0.023551326017269225, 0.22244756258992437, -0.02815954822477836, -0.26112429457144887, 0.06045545325415105, 1.4789035982503302e-56, 0.13047455901686297, -0.17986253178214648, -0.015284528512193585, 0.10604238169935515, 0.11802157369937255, -0.13455714782752567, 0.2027681355054191, 0.2059366619451666, 0.13311791933268313, -0.11302473371471357, -0.053568794683442514, 0.4023766615609095, 0.16148038562399106], [-0.16863254050556487, -0.1852151774288282, 0.1168172347298206, -0.004940428947981679, 0.0734994242159412, -0.024159357656843496, -0.11696092271934826, 0.21600313930195775, 0.2069000165791523, -0.1072635454052197, 0.06949653022986958, 0.23143416083659407, -0.09209419602176888, -0.005524001708393192, -0.1033762064654594, 0.14790353896378935, 0.04074889234965573, 0.007051735539778216, 1.2175515198999756e-56, -0.12092485502895535, 0.1386258804603353, 0.1161706516588818, -0.14516050078595147, 0.14988016771452178, 0.16229474991233173, -0.1147366557994959, 0.1996332834837357, 0.150474817246301, -0.08298604494064353, 0.15240970272663878, -0.034063806527057046, -0.267662515859173], [-0.1520572783751669, 0.2148088383729501, 0.10950594980594335, -0.15124274962995546, -0.01219738941399398, 0.04653632613641977, -0.20658530937361794, 0.21280875968561613, 0.1364798388138889, -0.16921698809224975, 0.25086294403783044, -0.06284217417146275, 0.23299983028856727, 0.04596498229529197, 0.09638327373904478, -0.15607817517971243, 0.1709590567802138, -0.12387029146390925, -0.1536789571910362, -0.21442157286286007, 0.016556577992808953, 0.01641159294242242, 0.11722266048424217, 0.2099961841385441, -0.17052083163627121, 0.16327663746259038, -0.24605022827000345, 0.11604448010204155, 0.1473394243606404, 0.01671097871414192, 0.13967320046057846, -0.09612014276779426], [-0.0950073817518474, 0.13237586377333369, -0.09699847646532068, -0.0142285980103991, -0.14125438917458139, 0.10464934184569659, -0.12157532923380125, -0.21464077174052643, -0.07473347649133766, 0.09398536025365656, -0.2375476874194128, -0.09352451950794148, -0.20697386836065104, -0.0385466544345715, -0.054459042521536355, 0.05323512490742406, 0.11446267672272133, 0.2671730890693388, -0.07314128383511898, 0.16967335630287386, 0.12400852016276943, 0.18444339804434276, 0.036431900236700315, -0.2729980996384248, 0.07793221800582688, 0.3844066528639521, 0.12009225402400743, -0.18570759995700728, -0.18946357027377791, 0.2626982949499202, 0.10341117907698914, 0.31669005647469795], [-0.12847629660735452, 0.08051313178336954, 0.09900559624736617, -0.06805589834500535, -0.0914889185643929, -0.14789213503955848, -0.1563921671982112, 0.023083339515333107, 0.14149080084380394, 0.06262804042392489, 0.1305768478943448, 0.14133424105566186, 0.24095385822849782, 0.10770357119364497, -0.12770182646246267, 0.15195034912767139, 0.09392844946294471, 0.040707909997819675, -0.18214739582073214, 0.0642641013840575, -0.05307469868484081, 0.2242889821763982, -0.021212956231604244, -0.06120709959974763, 0.2696449796135933, -0.2921624326269382, -0.05173815942489274, -0.3001186945401301, 0.11137333397725696, 0.20910129767471058, 0.054237205707935256, 0.1823950423335469], [-0.08009429431976434, 0.20273309178933893, 0.18646346827430477, 0.1034059116709901, -0.22577065028252227, 0.22697854339240955, 0.20514048075726274, -0.04920255327285677, 0.16829888821244557, -0.019345776512879973, 0.13600821534732177, -0.14026715003622123, 0.1348042186129304, 0.05125515420831661, -0.06625693034656467, -0.07750560816020499, -0.2915895935162212, -0.019223253876627586, -2.558399773587734e-66, -0.028663568529638205, -0.13708801796051467, -0.007359723400776757, 0.13629989220703323, -0.17889790361045316, 0.2687772191832924, 0.19392164126438113, 0.12852299776246776, 0.0073084834490448215, 0.264898602184212, -0.15031134957017875, -0.10673446664959212, -0.20905870723747857], [0.10506047792270706, -0.18321726507521532, -0.016758762932857326, 0.26771339162606683, 0.19936134575273023, -0.06700824450407139, -0.1733004830334242, 0.11409786458805414, -0.06337499093855671, -0.15259083549027935, -0.11086382787361085, 0.15061479094051713, 0.09875464023894916, 0.12012134045140335, 0.2366882173867781, 0.11555224427626462, -0.02659330893531112, 0.09627057501472402, -1.099614751588786e-67, -0.15183872363050532, 0.16041203699031806, 0.056482152402160334, 0.16684588980314136, -0.005256417701706775, 0.10150479377044935, -0.04286180573172825, 0.058840809492185314, 0.1765405199635732, -0.1615146317368109, 0.009636668714920202, 0.01029072675610088, -0.04807713017636101], [-0.055447833134901925, 0.11344993486411445, 0.18834852234487232, 0.10293010877900471, 0.15934577387891932, 0.026224778153007534, 0.15065987065339007, -0.09021693964569125, -0.08913795663904175, -0.06305828039575988, 0.02391043979587974, -0.24662262305342295, -0.08128808125808135, -0.14051925948817975, 0.272808595944695, -0.045080436681208064, -0.03160916535750446, -0.03683951292469965, 0.035389718599463785, -0.09435156106543505, -0.24717394571141102, 0.004324912258567688, -0.2961752196504434, -0.2107716148031438, -0.09730820787673466, -0.11549417496282822, -0.2368142474464895, -0.16229662328635253, 0.12535726074019185, 0.1175704124742059, -0.014884453552825309, -0.034179401815937746], [0.20177671977760248, 0.0022088015077662247, -0.17265430210078353, 0.08944961467658488, -0.12825600284330052, -0.11841762447245822, 0.08383360875258557, 0.22124801340939923, -0.040559250228317724, 0.08821596054820512, 0.28469448302805633, -0.19311103122622342, -0.1706628011833806, -0.10572753829721532, 0.009658681055197633, 0.008232372242186823, 0.14834728539289813, 0.14014422736067608, 0.03343077589494417, -0.12598580230675155, 0.15379388164886154, 0.1432057751215098, 0.12609510836181428, -0.1690709325573404, 0.12359012831727127, -0.2552918930827899, -0.13226700334523103, -0.29861197530162537, -0.0144875909278611, 0.12120815410371343, -0.21140406819423793, -0.054003705472843506], [-0.012105120350149334, -0.022067210466472607, -0.16196779128131136, -0.03682716840302323, 0.14824932038436137, -0.2156480267969037, -0.14685743532837303, -0.042214540849478635, 0.21959137699169787, 0.06009185556240592, 0.17701999752840034, 0.022643820010908738, -0.013004126238685215, -0.2668514511527201, 0.12576811535363513, 0.23321258153331617, 0.025598545219235116, 0.26818934465542327, 0.08141462700685613, -0.2994546935705709, 0.2525616115418418, -0.20015589004537546, -0.026310939390075914, -0.11648765373170603, -0.20257881641335218, -0.6564203234393711, -0.10873392539441526, -0.025498352545244303, -0.0038759181090784445, -0.2088289273207177, -0.1728949844271266, 0.16325525033945576], [-0.020553401884905887, 0.14982392820359852, 0.17032789623208627, 0.12263312257159496, 0.12742143895259148, -0.08084805009103603, 0.12497490301229901, -0.049976518439099865, -0.16094053340004272, 0.19330710091582626, -0.03303021991372116, 0.1519871018486213, 0.15949184042262554, 0.16620959796713836, 0.22203116917719637, 0.009692502209937103, -0.12194476514733547, 0.08954342861107648, 1.2892953496335496e-73, 0.05348864269725666, 0.08853340358701077, 0.1117010147002369, -0.052584635063261165, -0.16228952370497743, 0.014537822884980001, -0.09553315185620856, 0.22092598271681427, -0.10913977863782305, -0.17090809367684034, -0.2745450404281146, 0.12281513167752152, 0.01825884049907031], [-0.05531412539265608, -0.21763884437140701, -0.023513939844477423, 0.06219847262621585, 0.08449650611708376, 0.05711869485985194, -0.13001522591315132, -0.062102768664862605, 0.2651529085795851, -0.0766286323030976, 0.09422853665386524, -0.20433325710706277, -0.01445531810341816, -0.26698394098670447, 0.024556831074081246, 0.23310918284157106, -0.029326051146699676, -0.012002590055998179, 4.4494499441598127e-38, -0.07870284076760146, -0.2762121594722367, -0.24865247927116235, 0.11708178818253508, -0.01803787130403234, -0.1626060445863529, 0.22469837077388352, -0.0948623641015158, -2.4611380549991995e-40, -0.08861081487501327, 0.24630419799391476, 0.1021184253081393, 0.18311217364092033], [0.23187289516127715, -0.13176255412990445, 0.28861681502500913, 0.08797858948087031, -0.06009918742574384, -0.05022538739941189, -0.04706295182042595, -0.1808058783010623, 0.07017481694464205, -0.04763601930726697, 0.06967268851682741, 0.22141924774724495, -0.060034066326059614, -0.05137883909428983, -0.13997620819369896, -0.11752032244593681, -0.17507599863747372, 0.05442915606599064, 6.454505227403738e-63, 0.2472174940316375, -0.38550083883859887, -0.02622838404992037, 0.11173637355254562, -0.19483891864056543, -0.04969039884379224, 0.04053205442306296, 0.016926178068727118, 0.019304564809453053, 0.18961140326234788, 0.07828901255307139, 0.08086700347867398, 0.09211343534816344], [0.02753836529822224, -0.1742913362710494, -0.013276579251549481, -0.18932434185181027, -0.028329198638679408, 0.02299228519388922, -0.12776392129084882, 0.20619921831656132, 0.26499520959275263, -0.06941585643677288, -0.02175095321061063, 0.14872392565798556, -0.18251987084955495, 0.17562149066037383, -0.16787962106212295, 0.1307110728266267, -0.14712582747080483, 0.2011709708060536, 1.5034354205373204e-40, 0.06469180323553665, -0.36598768732019726, 0.3992969359288802, 0.04436718677896928, 0.16050295388262242, 0.11735849080465761, -0.07132723241838468, -0.07373161855631483, -0.13884646216287003, 0.19048993887591187, -0.02550852734864467, 0.052646996174463334, 0.023328413009848253], [0.034752401222402904, 0.20341462857331238, 0.24655867321049615, 0.07081027323577573, 0.18361336991310206, 0.1366992077854999, 0.07325007746780553, 0.2552591890118118, -0.1365042241245691, -0.19517975776054686, 0.1950829497116804, -0.049234432449175046, 0.17711725309387505, 0.17043423664174173, -0.17695531543638338, 0.19709289975659822, -0.04505653196041757, -0.05120398573658192, 0.0396411314151149, 0.25044163662832764, -0.2094238461881719, 0.04372650150051258, 0.08038209502572387, 0.12179261795326823, 0.1516914578192509, -0.19616156401085574, -0.13529310679599016, 0.0320890970029117, 0.12544337445891304, -0.17195228262324314, -0.12254239622106801, 0.2546522591673843], [-0.20710976665956077, 0.17954987214809529, 0.07053977627779777, 0.18195493749994243, -0.2476781923135848, -0.17291325608477492, 0.10315093962781571, 0.10657327616710736, 0.029488129560697508, -0.3117030181204463, 0.07262079094150606, 0.2113637295590882, 0.07035119839601509, 0.21971872098017234, 0.2150750386706252, -0.14484001486568615, -0.29797950780650495, 0.042009280322071595, 5.520444420695992e-43, 0.04403426581833574, 0.13911647821245615, -0.19067316567574016, -0.10342920789504799, 0.003623238584615286, 0.15906282603455976, -0.031536764313677704, -0.1930105662485237, 0.22923885723495294, 0.11193004954781054, -0.03899304738476509, -0.09647505357580663, 0.23215427493371624], [0.14263064387161148, 0.03148858760183167, -0.24727817913129996, -0.14507862217484763, -0.1732205924768155, 0.007616690305987299, -0.17656352079664736, -0.1270148432730738, 0.15597886933084743, 0.03812110529900543, -0.0427293757078707, 0.29319451316245193, -0.13123261246823384, 0.0831935364651854, -0.14136097770937525, -0.09782438506060874, 0.3583000467174459, -0.08014130075208248, 9.366406735163654e-72, -0.39409720550827504, -0.16238092572451426, 0.17679598024490462, -0.04917787647171858, -0.10271384176639861, 0.08693429789117618, -0.11672046313521336, -0.2489572350299782, 0.09181378152555246, -0.08756420594689027, 0.20547450185085808, 0.19254913804976204, 0.2019992533168759], [0.07566894854136207, -0.04131780934057643, -0.0948068517246335, 0.08978018900068559, -0.16646031883758275, 0.025383982401161805, -0.12268063105205407, -0.15871554471737245, 0.01837622821589116, -0.0526136072483443, -0.12003278666068372, -0.049913303775188586, -0.22657538196394744, 0.11958271808394419, -0.2627149787631758, -0.12703297595020907, 0.09540562877437579, -0.370043276474125, -2.7793910250305675e-51, 0.06945794912205878, -0.04933912022263161, 0.11995873122973888, -0.12517744812711734, -0.1718038587662909, -0.13507295817066206, -0.20806629192605736, 0.20942728859184687, -0.11401702109592995, 0.1570750067124237, 0.1940775075187516, 0.11773806173200563, 0.2216680036552931], [-0.09280809258717786, 0.20910345988622853, -0.1824076567680954, 0.0967758022333888, -0.04373815896618768, -0.040942510810160135, 0.024027775323829027, 0.04519650494109237, -0.2676221681218599, -0.2350977088347677, 0.08579370324201904, 0.10056187907325208, 0.38919036060088263, 0.13343342056214177, 0.15104507668425934, 0.08298030223240949, -0.12389102425538101, -0.2389499386552591, 0.09487697064950643, 0.026042285897655254, -0.1010923660084103, -0.06465613065833538, 0.2039414734699433, 0.013124341776751482, -0.046068991489789685, 0.08445661149964309, -0.16054590402523777, 0.03769369143189803, -0.08799365167064956, -0.17755133631235015, 0.21027337726863332, -0.0056815468015251995], [0.1926367033346683, 0.1689228358981642, -0.03661193346113139, 0.024120304375403547, -0.004984000560368007, 0.11467201920514719, -0.17584992159473642, 0.1511669452773781, 0.025041533629201404, -0.02665265876825892, -0.2181035763358895, 0.09926633893063341, 0.13343305754028467, -0.120425311736881, 0.07219559081161281, -0.017546389774303155, 0.11559870091743045, 0.03910524886216332, 6.692863344906726e-46, -0.12564438553689686, -0.030259778625870887, -0.1894350085055512, -0.1426983226751377, 0.035655285379262464, -0.16712996026912955, 0.18725186310101255, -0.16556556169967898, -0.05576412176066588, -0.0672882039878095, -0.34227452395256597, -0.08634671157232279, -0.10131945874317022], [-0.050129422314570016, -0.0324211880105229, -0.08787102355337062, 0.1079749067605302, -0.23392038760313966, -0.048158082067167145, 0.22414587610899941, 0.0021627836540827647, 0.044275120162355505, -0.20162814234087684, 0.16397695058209308, 0.13698249474061652, -0.008045824263350028, 0.21800957587862932, -0.1658352214862882, -0.24587711695703127, 0.11437157841863602, 0.15301826536917462, -0.1806876353079558, -0.11608477066763694, -0.1778509873648104, -0.10712678397240215, 0.05299173289114781, 0.01902299900910045, -0.05307855392327518, -0.11257129627806997, -0.18283212798734857, -0.1082570441240436, 0.036306319674894554, 0.20729242218132818, 0.1885644433426415, -0.21183728784939343], [0.2215548939042896, 0.15268583309029538, 0.1050851048954142, -0.046846645023780165, -0.054720724353690575, -0.13974464613978574, -0.18936044722637974, -0.0017956812883738907, -0.22011065731017818, 0.12763592129230075, 0.1217742659028631, -0.0012341621538575613, -0.26269733588481264, 0.21892163594707592, 0.239391505470654, 0.15401005536564166, 0.2261808957803556, 0.3194056622942507, 0.18879698097022496, -0.2883229903930546, 0.028749793041200802, -0.17814285112022435, -0.24181898855652167, -0.1515376022552706, 0.034248946449365276, 0.4805195895563861, 0.12495601044444524, -0.22554223854659597, 0.09444499053360723, 0.07317065691300667, 0.0835195606952638, 0.08487764935507058], [0.024850105052209526, -0.03573768547213319, 0.33631864375861353, -0.18852297132836857, 0.08472209392108657, 0.131484982239282, 0.1781008306715554, -0.11426730022890917, -0.1689861593185721, -0.20252889943393457, 0.0638259611427767, 0.008380620038628923, -0.18950883128946822, 0.24625914623178927, 0.09445951254822307, -0.00924430686954033, -0.042427179189075875, 0.2114094256867765, 5.020829899177663e-43, -0.027771542128057033, -0.16434117338449683, 0.020422497851430545, 0.055019052290205386, 0.0352059879903526, -0.2750965357374488, -0.002414480382856496, 0.014203721778022102, -0.2914679369542811, -0.2557779579716354, 0.1842019499452151, 0.27246624089743754, 0.07529948068416045], [0.17446345453181814, -0.14346774781724125, 0.10998039016826623, -0.10664944719585298, 0.16989731250907786, 0.2795771289059587, 0.011156731513479599, 0.1684677309990326, 0.04205913506929034, -0.1283057641905925, 0.04912381297005367, 0.06155122213658482, -0.25800356926474843, 0.030606459035181225, 0.24765827209073094, -0.17470358810204253, 0.13116197110253416, 0.17193425647306174, 0.12374056464100018, 0.14412112689550902, 0.013841744062228914, 0.17957664948729912, 0.10148743810662623, -0.11828668051691248, 0.03763345711910064, 0.07441839283699303, -0.17708411426072662, 0.04993860419332176, 0.0602830464301142, -0.09175129138251453, -0.04945095384660338, 0.1990559576432709], [0.05008012089781583, -0.27099661654862284, -0.20748267820015034, -0.09016629784569177, 0.14096680211842877, -0.1806958097049859, 0.049972154609709406, -0.1881839606514514, -0.21639025206928603, 0.14264169945196853, 0.1394735782662731, -0.1075633328607923, -0.13695100555144812, -0.2009292866051476, -0.043057788030725824, 0.05418334647247077, -0.3993371694084172, 0.013037420444193891, -2.261773304461617e-75, 0.18477871660808712, 0.35058182474371835, -0.4374543548853513, 0.03732727222665916, -0.09143193036193838, -0.06135789222996572, -0.11053946116681633, 0.20506506680266337, 0.2303853969303378, 0.014459617874554302, 0.01664973810449449, 0.0897380797146623, 0.036722372406624626], [0.022030557992119074, -0.03502180545978455, 0.0299680134993302, -0.1788942828389655, -0.14084386440862445, 0.1726439717116145, -0.16029661653743255, -0.02779746642486183, -0.23117052812784866, -0.39707312387006827, -0.1777030441224297, -0.17262593465477793, 0.09623192334195374, -0.14010435968447732, 0.2546446555902777, 0.04242531456980318, -0.08076852401729043, -0.01048915843076509, -0.003080977779515087, 0.17470175067424804, -0.09195520677576377, -0.1750232901568587, 0.1457789019067666, 0.17154600694298192, 0.24571002278381238, -0.09194174433028388, 0.11507377710073215, -0.023514186207796956, -0.041481353005627705, -0.1236497432142724, -0.07531133969746694, -0.08966042701960904]]
B2 = [-0.09883898458642296, 0.22700745784646353, -0.06628524030034123, -0.22825308807754255, -0.1574535284131855, 0.1812084891410179, 0.10139322096198254, 0.0348261561514939, 0.17638019053757817, 0.183638230452186, -0.09095633022642113, 0.09897549354189966, 0.1295879662443834, 0.052495060930640776, -0.12537876538889176, 0.22002508523020983, -0.02206120596313135, -0.09021247888280826, -0.05099916139494162, -0.20184513820383043, -0.24797479680917472, 0.10130029819082967, -0.3034835632220933, 0.004395374618363936, 0.08109521261413244, -0.2544545785344416, 0.1725194025871062, -0.2359403118214924, -0.14034146586901158, -0.06831027156729659, -0.1282021658910841, -0.2694655397504048]
W3 = [[0.12346715922611672, 0.3514748321100371], [-0.2637804577655711, 0.16131237888984784], [0.1746016756705547, 0.2983578543247934], [-0.13117088867234905, -0.22141077821615363], [-0.16599922499101766, 0.16175662235300128], [0.2583277120867274, -0.20435328183124904], [-0.21009776208577008, 0.3799731960113111], [0.13062201207371021, 0.44099820951829244], [0.19588087854575598, -0.17095924350686142], [0.043461831710610334, 0.3699297525612886], [-0.3713460149851042, 0.05420723490817334], [0.22716611070681642, -0.23008233389195898], [0.24661164901520527, 0.074176856761457], [0.36194165483711194, -0.3726411224989606], [-0.2532964367495173, 0.06220477309081108], [-0.10866076712608005, 0.19558129389357914], [0.229384901275801, -0.3847844681460849], [0.11418903343235169, 0.14427878422349663], [-0.012032601051950066, 0.2599113111046608], [0.35951976249029954, -0.20000313552687063], [0.21800843792840602, -0.13389036981522856], [0.4137451181803528, -0.062119463893477486], [0.20343361344171978, 0.2902116014897705], [-0.19750165708965803, 0.24833248388236373], [-0.3029483329582254, -0.04584282887315298], [-0.3133469325837288, 0.4885300031506479], [0.26766325771015526, 0.20201318473513863], [0.256922079177037, -0.07970759190499117], [0.35188839621642715, -0.009894296571296141], [-0.10899361133829237, -0.26053239657973065], [0.3114409869859662, 0.21017717871478586], [-0.09625030528444928, -0.42586910444347703]]
B3 = [0.2504682379596909, -0.36180650183438395]
# =========================================================

model = GatewayMLP(W1, B1, W2, B2, W3, B3, X_MEAN, X_STD, Y_MEAN, Y_STD)

# =========================================================
# 2. MQTT 클라이언트
# =========================================================
BETA_TEMP = 0.5
BETA_HUM = 3.0

def _mqtt_publish(client, payload_dict, qos=0):
    payload = json.dumps(payload_dict)
    try:
        client.publish(MQTT_TOPIC_READINGS, payload, qos=qos)
    except Exception:
        try:
            client.reconnect()
            client.publish(MQTT_TOPIC_READINGS, payload, qos=qos)
        except Exception as e2:
            print(f"   MQTT publish error: {e2}")

mqtt_client = mqtt.Client()
try:
    mqtt_client.connect(MQTT_BROKER, MQTT_PORT, 60)
    mqtt_client.loop_start()
    print(f"MQTT connected to {MQTT_BROKER}:{MQTT_PORT}")
except Exception as e:
    print(f"MQTT connect warning: {e} (계속 실행, 나중에 publish 시도)")

# =========================================================
# 3. 시스템 초기화
# =========================================================
SERIAL_PORT = os.environ.get("SERIAL_PORT", "/dev/ttyUSB0")
try:
    ser = serial.Serial(SERIAL_PORT, 115200, timeout=1)
    ser.flush()
except Exception as e:
    print(f"Error: Serial Port not found (tried {SERIAL_PORT}). Check USB connection and .env SERIAL_PORT. {e}")
    exit()

print("=== Gateway (Rolling Window MLP 12-64-32-2 ReLU, window=4) Started ===")
LV_TIMEZONE = timezone(timedelta(hours=-8))
print("=== Logging via MQTT topic:", MQTT_TOPIC_READINGS, "===")

total_tx_count = 0
last_est_log_time = time.time()

pred = model.predict()

try:
    while True:
        now_lv = datetime.now(LV_TIMEZONE)
        time_n = ((now_lv.hour * 3600) + (now_lv.minute * 60) + now_lv.second) / 86400.0

        if time.time() - last_est_log_time >= 60:
            model.shift_window(pred[0], pred[1], time_n)
            pred = model.predict()

            _mqtt_publish(mqtt_client, {
                "event": "EST",
                "timestamp": now_lv.strftime("%Y-%m-%d %H:%M:%S"),
                "time_n": round(time_n, 4),
                "actual_t": None,
                "actual_h": None,
                "pred_t": round(float(pred[0]), 2),
                "pred_h": round(float(pred[1]), 2),
                "error_t": None,
                "error_h": None,
                "total_tx": total_tx_count,
            }, qos=0)
            last_est_log_time = time.time()

        if ser.in_waiting > 0:
            line = ser.readline().decode('utf-8', errors='ignore').strip()

            if "Received:" in line:
                try:
                    gateway_receive_ms = int(time.time() * 1000)
                    payload = line.split("Received: ")[1]
                    parts = [p.strip() for p in payload.split(",")]

                    if len(parts) >= 3:
                        edge_timestamp_ms = int(parts[0])
                        actual_t = float(parts[1])
                        actual_h = float(parts[2])
                        transmission_delay_ms = gateway_receive_ms - edge_timestamp_ms
                    else:
                        actual_t = float(parts[0])
                        actual_h = float(parts[1])
                        transmission_delay_ms = None

                    if actual_t == 0.0 and actual_h == 0.0:
                        print(f"[{now_lv.strftime('%H:%M:%S')}] Sync Ping - Only Time Sent")
                        ser.write(f"{int(time.time())}\n".encode())
                        continue

                    total_tx_count += 1
                    err_t = abs(actual_t - float(pred[0]))
                    err_h = abs(actual_h - float(pred[1]))

                    print(f"\n[{now_lv.strftime('%H:%M:%S')}] Data RX! (TX Count: {total_tx_count})")
                    print(f"   Actual: {actual_t:.2f}C / {actual_h:.2f}% | Pred: {pred[0]:.2f}C / {pred[1]:.2f}%")
                    if transmission_delay_ms is not None:
                        print(f"   Transmission delay: {transmission_delay_ms} ms")

                    is_aoii = (err_t >= BETA_TEMP or err_h >= BETA_HUM)
                    payload_out = {
                        "event": "RX",
                        "timestamp": now_lv.strftime("%Y-%m-%d %H:%M:%S"),
                        "time_n": round(time_n, 4),
                        "actual_t": round(actual_t, 2),
                        "actual_h": round(actual_h, 2),
                        "pred_t": round(float(pred[0]), 2),
                        "pred_h": round(float(pred[1]), 2),
                        "error_t": round(err_t, 2),
                        "error_h": round(err_h, 2),
                        "total_tx": total_tx_count,
                    }
                    if transmission_delay_ms is not None:
                        payload_out["transmission_delay_ms"] = transmission_delay_ms

                    _mqtt_publish(mqtt_client, payload_out, qos=1 if is_aoii else 0)

                    model.online_update(actual_t, actual_h, lr=0.01)
                    model.shift_window(pred[0], pred[1], time_n)
                    pred = model.predict()

                    ser.write(f"{int(time.time())}\n".encode())
                    last_est_log_time = time.time()

                except Exception as e:
                    print(f"Error parsing: {e}")

        time.sleep(1)

except KeyboardInterrupt:
    print(f"\nGateway Stopped. Total TX: {total_tx_count}")
    ser.close()
